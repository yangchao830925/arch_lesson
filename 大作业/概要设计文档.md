# 1 设计概述
通达快递系统是一个直接面向C端用户的互联网系统，是公司互联网转型战略的核心系统，承担着公司业务倍增的目标任务。

## 1.1 功能概述
系统使用者包括有快递需求的C端客户和公司快递员，系统主要功能如下所示：<br>
1、用户通过app发起快递下单请求并支付<br>
2、快递员通过自己的App上报自己的地理位置，每30秒上报一次<br>
3、系统收到快递请求后，向距离用户直线距离5km内的所有快递员发送通知<br>
4、快递员需要进行抢单，第一个抢单的快递员得到配单，系统向其发送用户详细地址<br>
5、快递员到用户处收取快递，并记录到系统中：已收件<br>
6、快递员将快递送到目的地，并记录到系统中：已送达

核心用例图如下：

![text](https://raw.githubusercontent.com/yangchao830925/arch_lesson/master/%E5%A4%A7%E4%BD%9C%E4%B8%9A/%E7%94%A8%E4%BE%8B%E5%9B%BE.png)

核心业务活动图如下：

![text](https://raw.githubusercontent.com/yangchao830925/arch_lesson/master/%E5%A4%A7%E4%BD%9C%E4%B8%9A/%E4%B8%9A%E5%8A%A1%E6%B4%BB%E5%8A%A8%E5%9B%BE.png)

## 1.2 非功能约束
预计系统上线后三个月日单超过1万，一年日单超过50万，核心指标如下：<br>
1、查询性能目标:平均响应时间<300ms，95%响应时间<500ms，单机TPS>100;<br>
2、下单性能目标:平均响应时间<800ms，95%响应时间<1000ms，单机TPS>30;<br>
3、系统核心功能可用性目标:>99.99%;<br>
4、系统安全性目标:系统可拦截常规网络攻击，密码数据散列加密，客户端数据HTTPS加密，外部系统间通信对称加密;<br>
5、数据持久化目标:>99.99999%。

# 2 设计思路及折衷
描述系统设计中需要解决或考虑的关键问题或难点问题。解决这些问题可能有不同方案, 在这里加入方案设计的选择, 折衷及解释，并在后面的系统设计中对选中的方案给出进一步阐述。建议分类列出，比如性能、可扩展性、安全性、服务稳定性、反作弊、复用等方面。建议使用调研数据支持设计方案的选择。

## 2.1 关键问题一：下单支付的高可用

## 2.2 关键问题二：快递员实时位置的读写高性能

## 2.3 关键问题三：派单和抢单的高并发

## 2.4 关键问题四：海量订单数据的存储问题

# 3 整体架构与设计

## 3.1 系统部署图
![text](https://raw.githubusercontent.com/yangchao830925/arch_lesson/master/%E5%A4%A7%E4%BD%9C%E4%B8%9A/%E9%83%A8%E7%BD%B2%E5%9B%BE.png)

## 3.2 下单抢单场景时序图
![text](https://raw.githubusercontent.com/yangchao830925/arch_lesson/master/%E5%A4%A7%E4%BD%9C%E4%B8%9A/%E6%97%B6%E5%BA%8F%E5%9B%BE.png)

## 3.3 订单状态图
![text](https://raw.githubusercontent.com/yangchao830925/arch_lesson/master/%E5%A4%A7%E4%BD%9C%E4%B8%9A/%E7%8A%B6%E6%80%81%E5%9B%BE.png)

# 4 订单模块设计

## 4.1 订单模块的组件图

## 4.2 订单模块的时序图

## 4.3 各组件的详细设计

# 5 抢单模块设计

## 5.1 抢单模块的组件图

## 5.2 抢单模块的时序图

## 5.3 各组件的详细设计

# 6 性能设计
该节描述此项目需要达到的性能指标，以及达到此性能而采用的算法、设计思想、策略。此节不必复述各模块的交互及其功能，只需突出性能考虑即可。

# 7 容灾设计
此节描述为了保证系统的安全、稳定运行，对于数据丢失、服务器无法连接等运行中可能发生的问题，所采取的容灾、保护策略。

# 8 开发计划
此节描述为了将开发周期以及计划信息同步出来，以便于所有人查看，如果是单独连接，可以连接进来

# 9 上线方案
